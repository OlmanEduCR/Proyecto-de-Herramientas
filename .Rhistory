y = "Frecuencia"
) +
theme_minimal()
grafico_internacional_genero <- function(datos, genero, internacional, pais) {
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#BA6F14", "#FF0000")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
gráfico_necesidad_genero <- function(df, genero, needs){
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
necesidades = factor({{needs}}, levels = c(0, 1),
labels = c("Sin necesidades especiales", "Con necesidades especiales"))
) %>%
group_by(genero, necesidades) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
ggplot(datos, aes(x = factor(Gender,
levels = c(0, 1),
labels = c("Mujer", "Hombre")))) +
geom_bar(fill = "#6049A6", color = "#42298A") +
labs(
title = "Distribución por Género",
x = "Género",
y = "Frecuencia"
) +
theme_minimal()
datos_faltantes <- datos %>%
filter(if_any(everything(),is.na))
head(datos_faltantes)
datos %>%
summarise(
across(
where(is.numeric),
~sum(
.<quantile(.,0.25,na.rm=TRUE)-1.5*IQR(.)|
.>quantile(.,0.75,na.rm=TRUE)+1.5*IQR(.),na.rm = TRUE
)
)
)#cantidad de outliners por variable
es_outlier <- function(x) {
if(!is.numeric(x)) return(rep(FALSE,length(x)))
q1 <- quantile(x,0.25,na.rm = TRUE)
q3 <- quantile(x,0.75,na.rm = TRUE)
resultado <- x<(q1-1.5*IQR(x,na.rm = TRUE))|
x>(q3+1.5*IQR(x,na.rm = TRUE))
return(resultado)
}
outliers <- as.data.frame(sapply(datos,es_outlier))
head(outliers)
datos_num <- datos %>%
select(
Previous.qualification..grade.,
Application.order,
Admission.grade,
Age.at.enrollment,
Curricular.units.1st.sem..credited.,
Curricular.units.1st.sem..enrolled.,
Curricular.units.1st.sem..approved.,
Curricular.units.1st.sem..evaluations.,
Curricular.units.1st.sem..grade.,
Curricular.units.1st.sem..without.evaluations.,
Curricular.units.2nd.sem..credited.,
Curricular.units.2nd.sem..enrolled.,
Curricular.units.2nd.sem..evaluations.,
Curricular.units.2nd.sem..approved.,
Curricular.units.2nd.sem..grade.,
Curricular.units.2nd.sem..without.evaluations.,
Unemployment.rate,
Inflation.rate
)
tabla_num <- data.frame(
Variables_Numericas = names(datos_num)
)
tabla_num
datos_cat <- datos %>%
select(
Marital.status,
Application.mode,
Course,
Daytime.evening.attendance.,
Previous.qualification,
Nacionality,
Mother.s.qualification,
Father.s.qualification,
Mother.s.occupation,
Father.s.occupation,
Displaced,
Educational.special.needs,
Debtor,
Tuition.fees.up.to.date,
Gender,
Scholarship.holder,
Age.at.enrollment,
International,
Target
)
tabla_cat <- data.frame(
Variables_Categoricas = names(datos_cat)
)
tabla_cat
# 4.1 Distribución de la variable objetivo
datos %>%
ggplot(aes(x = Target)) +
geom_bar(aes(y = after_stat(count/sum(count)), fill = Target)) +
geom_text(
aes(
y = after_stat(count/sum(count)),
label = paste0(round(after_stat(count/sum(count))*100, 1), "%")
),
stat = "count",
vjust = -0.5,
size = 4
) +
scale_fill_manual(values = c("steelblue", "firebrick", "darkgreen")) +
labs(title = "Distribución de Deserción Escolar",
x = "Estado del Estudiante",
y = "Proporción")
datos %>%
mutate(
Target = factor(Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor"))
) %>%
# Agrupar para proporciones
group_by(Gender, Target) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(Gender) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(Gender), y = prop, fill = Target)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.9) +
geom_text(
aes(label = paste0(round(prop * 100, 1), "%")),
position = position_stack(vjust = 0.5),
color = "white",
fontface = "bold",
size = 4
) +
scale_fill_manual(values = c("steelblue", "firebrick")) +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Distribución de Deserción por Género",
x = "Género (1 = Mujer, 0 = Hombre)",
y = "Proporción",
fill = "Estado"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
legend.position = "top"
)
datos %>%
mutate(
Target = factor(
Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor")
)
) %>%
ggplot(aes(x = Target, fill = Target)) +
geom_bar(aes(y = after_stat(count / sum(count)))) +
geom_text(
aes(
y = after_stat(count / sum(count)),
label = paste0(round(after_stat(count / sum(count)) * 100, 1), "%")
),
stat = "count",
vjust = -0.5,
size = 4
) +
scale_fill_manual(
values = c("No Desertor" = "steelblue",
"Desertor"    = "firebrick")
) +
labs(
title = "Distribución de Deserción Escolar",
x = "Estado del Estudiante",
y = "Proporción"
)
library(dplyr)
library(ggplot2)
library(tidyr)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
datos <- datos %>%
select(-GDP) ### El uso de esta variable es irrelevante
head(datos, 5)
columnas_seleccionadas <- datos[, c(
"Admission.grade",
"Age.at.enrollment",
"Previous.qualification..grade.",
"Curricular.units.1st.sem..grade.",
"Curricular.units.2nd.sem..grade."
)]
#pasa r chr a num y pasar int a num
columnas_seleccionadas <- as.data.frame(lapply(columnas_seleccionadas, function(x) {
if(is.character(x)) {
# Convertir a numérico (maneja decimales)
return(as.numeric(as.character(x)))
} else {
return(x)
}
}))
str(columnas_seleccionadas)
calcular_moda <- function(x){
x <- x[!is.na(x)]
if(length(x) == 0) return(NA)
tabla <- table(x)
moda <- as.numeric((names(tabla)[tabla == max(tabla)]))
return(moda[1])
}
estadisticas_descrip <- data.frame(
Media = sapply(columnas_seleccionadas, mean, na.rm = TRUE),
Mediana = sapply(columnas_seleccionadas, median, na.rm = TRUE),
Moda = sapply(columnas_seleccionadas, calcular_moda),
Desviacion_Estandar = sapply(columnas_seleccionadas, sd, na.rm = TRUE),
Minimo = sapply(columnas_seleccionadas, min, na.rm = TRUE),
Maximo = sapply(columnas_seleccionadas, max, na.rm = TRUE),
Rango = sapply(columnas_seleccionadas, function(x) diff(range(x, na.rm = TRUE)))
)
print(estadisticas_descrip)
par(mfrow = c(2, 4))  # Parámetros gráficos
nombres_var <- names(columnas_seleccionadas) # Extrae los nombres y los asigna al vector nombre_var
for(i in 1:ncol(columnas_seleccionadas)) { # Bucle para generar los histogramas, iterando sobre las variables del data frame
hist(columnas_seleccionadas[[i]], #Estructura que va a tener el histograma
main = nombres_var[i],
cex.main = 0.9,
xlab = "Valor",
ylab = "Frecuencia",
col = "lightblue",
border = "black")
}
datos_num <- datos %>%
select(
Previous.qualification..grade.,
Application.order,
Admission.grade,
Age.at.enrollment,
Curricular.units.1st.sem..credited.,
Curricular.units.1st.sem..enrolled.,
Curricular.units.1st.sem..approved.,
Curricular.units.1st.sem..evaluations.,
Curricular.units.1st.sem..grade.,
Curricular.units.1st.sem..without.evaluations.,
Curricular.units.2nd.sem..credited.,
Curricular.units.2nd.sem..enrolled.,
Curricular.units.2nd.sem..evaluations.,
Curricular.units.2nd.sem..approved.,
Curricular.units.2nd.sem..grade.,
Curricular.units.2nd.sem..without.evaluations.,
)
tabla_num <- data.frame(
Variables_Numericas = names(datos_num)
)
tabla_num
datos_cat <- datos %>%
select(
Marital.status,
Application.mode,
Course,
Daytime.evening.attendance.,
Previous.qualification,
Nacionality,
Mother.s.qualification,
Father.s.qualification,
Mother.s.occupation,
Father.s.occupation,
Displaced,
Educational.special.needs,
Debtor,
Tuition.fees.up.to.date,
Gender,
Scholarship.holder,
International,
Target
)
tabla_cat <- data.frame(
Variables_Categoricas = names(datos_cat)
)
tabla_cat
#install.packages("rcompanion")
#install.packages("ResourceSelection")
#install.packages("pROC")
#install.packages("car")
library(rcompanion)
library(ResourceSelection)
library(pROC)
library(car)
### Pasamos los casos de Desertor y Matriculado/Graduado a 1,0 respectivamente
datos$Target_bin <- ifelse(datos$Target == "Dropout", 1, 0)
datos$Target_bin <- factor(datos$Target_bin, levels = c(0, 1))
modelo <- glm(Target_bin ~ Age.at.enrollment +
Curricular.units.1st.sem..enrolled. +
Curricular.units.1st.sem..approved. +
Curricular.units.2nd.sem..enrolled. +
Curricular.units.2nd.sem..approved. +
Marital.status +
Course +
Displaced +
Educational.special.needs +
Debtor +
Tuition.fees.up.to.date +
Gender +
Scholarship.holder +
International +
Mother.s.qualification +
Father.s.qualification +
Mother.s.occupation +
Father.s.occupation,
data = datos,
family = binomial)
summary(modelo)
### Convertir coeficientes a Odds Ratios
exp(coef(modelo))
## intervalos de confianza
exp(confint(modelo))
### Evaluación del modelo
# Nagelkerke
nagelkerke(modelo)
# Matriz de confusión
prob <- predict(modelo, type = "response")
pred <- ifelse(prob > 0.5, 1, 0)
pred <- factor(pred, levels = c(0, 1))
table(Predicción = pred, Real = datos$Target_bin)
# Curva ROC y AUC
roc_curve <- roc(datos$Target_bin, prob)
auc(roc_curve)
### Revisar multicolinealidad (VIF)
vif(modelo)
datos %>%
mutate(
Target = factor(
Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor")
)
) %>%
ggplot(aes(x = Target, fill = Target)) +
geom_bar(aes(y = after_stat(count / sum(count)))) +
geom_text(
aes(
y = after_stat(count / sum(count)),
label = paste0(round(after_stat(count / sum(count)) * 100, 1), "%")
),
stat = "count",
vjust = -0.5,
size = 4
) +
scale_fill_manual(
values = c("No Desertor" = "steelblue",
"Desertor"    = "firebrick")
) +
labs(
title = "Distribución de Deserción Escolar",
x = "Estado del Estudiante",
y = "Proporción"
)
datos %>%
mutate(
Target = factor(Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor"))
) %>%
# Agrupar para proporciones
group_by(Gender, Target) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(Gender) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(Gender), y = prop, fill = Target)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.9) +
geom_text(
aes(label = paste0(round(prop * 100, 1), "%")),
position = position_stack(vjust = 0.5),
color = "white",
fontface = "bold",
size = 4
) +
scale_fill_manual(values = c("steelblue", "firebrick")) +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Distribución de Deserción por Género",
x = "Género (0 = Mujer, 1 = Hombre)",
y = "Proporción",
fill = "Estado"
)
datos %>%
mutate(
Target = factor(
Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor")
)
) %>%
count(Age.at.enrollment, Target) %>%
group_by(Age.at.enrollment) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = Age.at.enrollment, y = prop, color = Target)) +
geom_line(size = 1.3, alpha = 0.9) +
geom_point(size = 3) +
scale_color_manual(
values = c("No Desertor" = "steelblue",
"Desertor"    = "firebrick")
) +
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Proporción de Deserción según la Edad de Ingreso",
x = "Edad al momento de ingreso",
y = "Proporción",
color = "Estado"
)
datos %>%
mutate(
Target = factor(
Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No desertor", "No desertor", "Desertor")
)
) %>%
select(
Target,
Matriculados = Curricular.units.1st.sem..enrolled.,
Aprobados = Curricular.units.1st.sem..approved.
) %>%
pivot_longer(
cols = c(Matriculados, Aprobados),
names_to = "Variable",
values_to = "Valor"
) %>%
ggplot(aes(x = Target, y = Valor, fill = Variable)) +
geom_boxplot(alpha = 0.75, width = 0.7, outlier.size = 1.5) +
scale_fill_manual(
values = c("Matriculados" = "steelblue",
"Aprobados" = "firebrick")
) +
labs(
title = "Distribución de Créditos Matriculados y Aprobados en el 1er Semestre según Estado Académico",
x = "Estado académico",
y = "Número de créditos",
fill = ""
)
datos %>%
mutate(
Target = factor(
Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No desertor", "No desertor", "Desertor")
)
) %>%
select(
Target,
Matriculados = Curricular.units.2nd.sem..enrolled.,
Aprobados = Curricular.units.2nd.sem..approved.
) %>%
pivot_longer(
cols = c(Matriculados, Aprobados),
names_to = "Variable",
values_to = "Valor"
) %>%
ggplot(aes(x = Target, y = Valor, fill = Variable)) +
geom_boxplot(alpha = 0.75, width = 0.7, outlier.size = 1.5) +
scale_fill_manual(
values = c("Matriculados" = "steelblue",
"Aprobados" = "firebrick")
) +
labs(
title = "Distribución de Créditos Matriculados y Aprobados en el 2do Semestre según Estado Académico",
x = "Estado académico",
y = "Número de créditos",
fill = ""
)
