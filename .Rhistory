ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
grafico_internacional_genero <- function(datos, genero, internacional, pais) {
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#BA6F14", "#FF0000")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
gráfico_necesidad_genero <- function(df, genero, needs){
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
necesidades = factor({{needs}}, levels = c(0, 1),
labels = c("Sin necesidades especiales", "Con necesidades especiales"))
) %>%
group_by(genero, necesidades) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
grafico_internacional_genero <- function(datos, genero, internacional, pais) {
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#BA6F14", "#FF0000")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
gráfico_necesidad_genero <- function(df, genero, needs){
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
necesidades = factor({{needs}}, levels = c(0, 1),
labels = c("Sin necesidades especiales", "Con necesidades especiales"))
) %>%
group_by(genero, necesidades) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
# Convertir Gender a factor y manejar valores faltantes
datos$Gender <- factor(datos$Gender,
levels = c(0, 1),
labels = c("Female", "Male"),
exclude = NULL)  # Esto incluye los NA como una categoría
# Opcional: Verificar si hay valores NA
sum(is.na(datos$Gender))
table(datos$Gender, useNA = "always")
# Graficar la distribución de Gender
ggplot(datos, aes(x = Gender)) +
geom_bar(fill = "steelblue") +
labs(title = "Distribución de Género", x = "Género", y = "Cantidad") +
theme_minimal() +
scale_x_discrete(drop = FALSE)  # Esto asegura que se muestren todas las categorías
ggplot(datos, aes(x = factor(Curricular.units.2nd.sem..evaluations.))) +
geom_bar(fill = "#C26827", color = "#000000") +
labs(
title = "Distribución de Evaluaciones - 2do Semestre",
x = "Cantidad de Evaluaciones",
y = "Frecuencia"
) +
theme_minimal()
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
library(dplyr)
# Se seleciona las variables cuantitaticas
variables_cuantitativas <- select_if(datos, is.numeric)
# Calcular resumen de 5 números para cada variable
#'Vamos a usar sapply para aplicar la funcion fivenum a la base
#'el firenum es una funcion que nos ayuda a calcular el minimo y maximo, los Q1 y Q3, ademas de eso la mediana
resumen_5_numeros <- sapply(variables_cuantitativas, fivenum)
#para no tener problema trasponemos a resumen_5_numeros
resumen_5_numeros <- t(resumen_5_numeros)
#'Para facilitar la lectura vamos a ponerle nosmbres claros a las columnas
colnames(resumen_5_numeros) <- c("Minimo","Q1","Mediana","Q3","Máximo")
print(resumen_5_numeros)
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
ggplot(datos, aes(x = factor(Curricular.units.2nd.sem..evaluations.))) +
geom_bar(fill = "#C26827", color = "#000000") +
labs(
title = "Distribución de Evaluaciones - 2do Semestre",
x = "Cantidad de Evaluaciones",
y = "Frecuencia"
) +
theme_minimal()
grafico_internacional_genero <- function(datos, genero, internacional, pais) {
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#BA6F14", "#FF0000")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
gráfico_necesidad_genero <- function(df, genero, needs){
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
necesidades = factor({{needs}}, levels = c(0, 1),
labels = c("Sin necesidades especiales", "Con necesidades especiales"))
) %>%
group_by(genero, necesidades) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
ggplot(datos, aes(x = factor(Gender,
levels = c(0, 1),
labels = c("Mujer", "Hombre")))) +
geom_bar(fill = "#6049A6", color = "#42298A") +
labs(
title = "Distribución por Género",
x = "Género",
y = "Frecuencia"
) +
theme_minimal()
datos_faltantes <- datos %>%
filter(if_any(everything(),is.na))
head(datos_faltantes)
datos %>%
summarise(
across(
where(is.numeric),
~sum(
.<quantile(.,0.25,na.rm=TRUE)-1.5*IQR(.)|
.>quantile(.,0.75,na.rm=TRUE)+1.5*IQR(.),na.rm = TRUE
)
)
)#cantidad de outliners por variable
es_outlier <- function(x) {
if(!is.numeric(x)) return(rep(FALSE,length(x)))
q1 <- quantile(x,0.25,na.rm = TRUE)
q3 <- quantile(x,0.75,na.rm = TRUE)
resultado <- x<(q1-1.5*IQR(x,na.rm = TRUE))|
x>(q3+1.5*IQR(x,na.rm = TRUE))
return(resultado)
}
outliers <- as.data.frame(sapply(datos,es_outlier))
head(outliers)
datos_num <- datos %>%
select(
Previous.qualification..grade.,
Application.order,
Admission.grade,
Age.at.enrollment,
Curricular.units.1st.sem..credited.,
Curricular.units.1st.sem..enrolled.,
Curricular.units.1st.sem..approved.,
Curricular.units.1st.sem..evaluations.,
Curricular.units.1st.sem..grade.,
Curricular.units.1st.sem..without.evaluations.,
Curricular.units.2nd.sem..credited.,
Curricular.units.2nd.sem..enrolled.,
Curricular.units.2nd.sem..evaluations.,
Curricular.units.2nd.sem..approved.,
Curricular.units.2nd.sem..grade.,
Curricular.units.2nd.sem..without.evaluations.,
Unemployment.rate,
Inflation.rate
)
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
datos <- datos %>%
select(-GDP) ### El uso de esta variable es irrelevante
head(datos, 5)
library(dplyr)
# Se seleciona las variables cuantitaticas
variables_cuantitativas <- select_if(datos, is.numeric)
# Calcular resumen de 5 números para cada variable
#'Vamos a usar sapply para aplicar la funcion fivenum a la base
#'el firenum es una funcion que nos ayuda a calcular el minimo y maximo, los Q1 y Q3, ademas de eso la mediana
resumen_5_numeros <- sapply(variables_cuantitativas, fivenum)
#para no tener problema trasponemos a resumen_5_numeros
resumen_5_numeros <- t(resumen_5_numeros)
#'Para facilitar la lectura vamos a ponerle nosmbres claros a las columnas
colnames(resumen_5_numeros) <- c("Minimo","Q1","Mediana","Q3","Máximo")
print(resumen_5_numeros)
ggplot(datos, aes(x = factor(Curricular.units.2nd.sem..evaluations.))) +
geom_bar(fill = "#C26827", color = "#000000") +
labs(
title = "Distribución de Evaluaciones - 2do Semestre",
x = "Cantidad de Evaluaciones",
y = "Frecuencia"
) +
theme_minimal()
grafico_internacional_genero <- function(datos, genero, internacional, pais) {
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#BA6F14", "#FF0000")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
gráfico_necesidad_genero <- function(df, genero, needs){
df_plot <- datos %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
necesidades = factor({{needs}}, levels = c(0, 1),
labels = c("Sin necesidades especiales", "Con necesidades especiales"))
) %>%
group_by(genero, necesidades) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = necesidades, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("#1250C4", "#8F0FD6")) +
labs(
title = "Distribución de Necesidades Educativas Especiales por Género",
x = "Condición",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
gráfico_necesidad_genero(datos, datos$Gender, datos$Educational.special.needs)
ggplot(datos, aes(x = factor(Gender,
levels = c(0, 1),
labels = c("Mujer", "Hombre")))) +
geom_bar(fill = "#6049A6", color = "#42298A") +
labs(
title = "Distribución por Género",
x = "Género",
y = "Frecuencia"
) +
theme_minimal()
datos_faltantes <- datos %>%
filter(if_any(everything(),is.na))
head(datos_faltantes)
datos %>%
summarise(
across(
where(is.numeric),
~sum(
.<quantile(.,0.25,na.rm=TRUE)-1.5*IQR(.)|
.>quantile(.,0.75,na.rm=TRUE)+1.5*IQR(.),na.rm = TRUE
)
)
)#cantidad de outliners por variable
es_outlier <- function(x) {
if(!is.numeric(x)) return(rep(FALSE,length(x)))
q1 <- quantile(x,0.25,na.rm = TRUE)
q3 <- quantile(x,0.75,na.rm = TRUE)
resultado <- x<(q1-1.5*IQR(x,na.rm = TRUE))|
x>(q3+1.5*IQR(x,na.rm = TRUE))
return(resultado)
}
outliers <- as.data.frame(sapply(datos,es_outlier))
head(outliers)
datos_num <- datos %>%
select(
Previous.qualification..grade.,
Application.order,
Admission.grade,
Age.at.enrollment,
Curricular.units.1st.sem..credited.,
Curricular.units.1st.sem..enrolled.,
Curricular.units.1st.sem..approved.,
Curricular.units.1st.sem..evaluations.,
Curricular.units.1st.sem..grade.,
Curricular.units.1st.sem..without.evaluations.,
Curricular.units.2nd.sem..credited.,
Curricular.units.2nd.sem..enrolled.,
Curricular.units.2nd.sem..evaluations.,
Curricular.units.2nd.sem..approved.,
Curricular.units.2nd.sem..grade.,
Curricular.units.2nd.sem..without.evaluations.,
Unemployment.rate,
Inflation.rate
)
tabla_num <- data.frame(
Variables_Numericas = names(datos_num)
)
tabla_num
datos_cat <- datos %>%
select(
Marital.status,
Application.mode,
Course,
Daytime.evening.attendance.,
Previous.qualification,
Nacionality,
Mother.s.qualification,
Father.s.qualification,
Mother.s.occupation,
Father.s.occupation,
Displaced,
Educational.special.needs,
Debtor,
Tuition.fees.up.to.date,
Gender,
Scholarship.holder,
Age.at.enrollment,
International,
Target
)
tabla_cat <- data.frame(
Variables_Categoricas = names(datos_cat)
)
tabla_cat
# 4.1 Distribución de la variable objetivo
datos %>%
ggplot(aes(x = Target)) +
geom_bar(aes(y = after_stat(count/sum(count)), fill = Target)) +
geom_text(
aes(
y = after_stat(count/sum(count)),
label = paste0(round(after_stat(count/sum(count))*100, 1), "%")
),
stat = "count",
vjust = -0.5,
size = 4
) +
scale_fill_manual(values = c("steelblue", "firebrick", "darkgreen")) +
labs(title = "Distribución de Deserción Escolar",
x = "Estado del Estudiante",
y = "Proporción")
datos %>%
mutate(
Target = factor(Target,
levels = c("Graduate", "Enrolled", "Dropout"),
labels = c("No Desertor", "No Desertor", "Desertor"))
) %>%
# Agrupar para proporciones
group_by(Gender, Target) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(Gender) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(Gender), y = prop, fill = Target)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.9) +
geom_text(
aes(label = paste0(round(prop * 100, 1), "%")),
position = position_stack(vjust = 0.5),
color = "white",
fontface = "bold",
size = 4
) +
scale_fill_manual(values = c("steelblue", "firebrick")) +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Distribución de Deserción por Género",
x = "Género (1 = Mujer, 0 = Hombre)",
y = "Proporción",
fill = "Estado"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
legend.position = "top"
)
