library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
#str(datos)
variables_cuantitativas <- names(select(datos, where(is.numeric)))
for (var in variables_cuantitativas){
h <- ggplot(datos, aes_string(x=var))+
geom_histogram(fill = "#66CDAA", color = "#79CDCD", bins = 30) +
labs(title = paste("Histograma de", var), x = var, y = "Frecuencia") +
theme_minimal()
print(h)
}
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
#str(datos)
variables_cuantitativas <- names(select(datos, where(is.numeric)))
for (var in variables_cuantitativas){
h <- ggplot(datos, aes_string(x=var))+
geom_histogram(fill = "#66CDAA", color = "#79CDCD", bins = 30) +
labs(title = paste("Histograma de", var), x = var, y = "Frecuencia") +
theme_minimal()
print(h)
}
data <- read.delim("C:/Users/oecam/Proyecto-de-Herramientas/data.csv", header=FALSE)
View(data)
library(readxl)
data <- read_excel("data.csv")
library(dplyr)
library(ggplot2)
datos <- read.csv2("data.csv", sep = ";", header = TRUE, stringsAsFactors = FALSE)
head(datos, 5)
datos
grafico_internacional_genero <- function(df, genero, internacional, pais) {
g <- ggplot(df_plot,
aes(axis1 = genero, axis2 = internacional, axis3 = pais,
y = Frecuencia)) +
geom_alluvium(aes(fill = genero), width = 0.25, alpha = 0.8) +
geom_stratum(width = 0.25, fill = "grey90", color = "grey50") +
geom_text(stat = "stratum", aes(label = after_stat(stratum)), size = 3.2) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Relación entre género e internacionalidad",
subtitle = "Distribución de hombres y mujeres según condición internacional y país",
y = "Número de casos",
x = NULL,
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.y = element_blank()
)
print(g)
}
grafico_internacional_genero <- function(df, genero, internacional, pais) {
g <- ggplot(df_plot,
aes(axis1 = genero, axis2 = internacional, axis3 = pais,
y = Frecuencia)) +
geom_alluvium(aes(fill = genero), width = 0.25, alpha = 0.8) +
geom_stratum(width = 0.25, fill = "grey90", color = "grey50") +
geom_text(stat = "stratum", aes(label = after_stat(stratum)), size = 3.2) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Relación entre género e internacionalidad",
subtitle = "Distribución de hombres y mujeres según condición internacional y país",
y = "Número de casos",
x = NULL,
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.y = element_blank()
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
g <- ggplot(df,
aes(axis1 = genero, axis2 = internacional, axis3 = pais,
y = Frecuencia)) +
geom_alluvium(aes(fill = genero), width = 0.25, alpha = 0.8) +
geom_stratum(width = 0.25, fill = "grey90", color = "grey50") +
geom_text(stat = "stratum", aes(label = after_stat(stratum)), size = 3.2) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Relación entre género e internacionalidad",
subtitle = "Distribución de hombres y mujeres según condición internacional y país",
y = "Número de casos",
x = NULL,
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.y = element_blank()
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
library(ggalluvial)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
g <- ggplot(df_plot, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
g <- ggplot(df, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor(.data[[genero]], levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = ifelse(.data[[internacional]] == 1, "Internacional", "Nacional"),
pais = as.factor(.data[[pais]])
) %>%
group_by(genero, pais, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
g <- ggplot(df_plot, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, "genero", "internacional", "pais") {
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = ifelse({{internacional}} == 1, "Internacional", "Nacional"),
pais = as.factor({{pais}})
) %>%
group_by(genero, pais, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
g <- ggplot(df_plot, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = ifelse({{internacional}} == 1, "Internacional", "Nacional"),
pais = as.factor({{pais}})
) %>%
group_by(genero, pais, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
g <- ggplot(df_plot, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = ifelse({{internacional}} == 1, "Internacional", "Nacional"),
pais = as.factor({{pais}})
) %>%
group_by(genero, pais, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
g <- ggplot(df_plot, aes(x = pais, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución por país y género",
subtitle = "Portugal (1) representa los casos nacionales",
x = "Código de país",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 50, hjust = 1)
)
print(g)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
library(readxl)
data <- read_excel("data.csv")
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Tipo de persona",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
grafico_internacional_genero <- function(df, genero, internacional, pais) {
df_plot <- df %>%
mutate(
genero = factor({{genero}}, levels = c(1, 0), labels = c("Hombres", "Mujeres")),
tipo = factor({{internacional}}, levels = c(0, 1), labels = c("Nacional", "Internacional"))
) %>%
group_by(genero, tipo) %>%
summarise(Frecuencia = n(), .groups = "drop")
ggplot(df_plot, aes(x = tipo, y = Frecuencia, fill = genero)) +
geom_col(position = "dodge", width = 0.7) +
geom_text(aes(label = Frecuencia),
position = position_dodge(width = 0.7),
vjust = -0.3, size = 3.5) +
scale_fill_manual(values = c("steelblue", "darkorange")) +
labs(
title = "Distribución de Internacionales y Nacionales por Género",
x = "Lugar de Procedencia",
y = "Frecuencia",
fill = "Género"
) +
theme_minimal(base_size = 12) +
theme(
legend.position = "bottom",
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 0, hjust = 0.5)
)
}
grafico_internacional_genero(datos, datos$Gender, datos$International, datos$Nacionality)
